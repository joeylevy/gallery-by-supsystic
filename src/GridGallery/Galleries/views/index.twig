{% extends 'grid-gallery.twig' %}

{% block header %}

    <nav id="supsystic-breadcrumbs" class="supsystic-breadcrumbs">
        <a href="{{ environment.generateUrl('galleries') }}">{{ environment.translate('Gallery by Supsystic') }}</a>
        <i class="fa fa-angle-right"></i>
        <a href="{{ environment.generateUrl('galleries') }}">{{ environment.translate('Galleries') }}</a>
    </nav>

{% endblock %}

{% block content %}

    <section id="gg-galleries">

        {% if galleries is not defined %}
            {# Show error here #}
        {% else %}

            <div class="gg-galleries-grid">
                {#<h2 style="margin-left: 10px;padding-bottom: 10px !important;border-bottom: 1px solid;">Gallery list</h2>#}

                {% for gallery in galleries %}
                    <div id="{{ gallery.id }}" class="gg-item gg-gallery">
                        <h3 class="gallery-title">{{ gallery.title|title }}</h3>
                        <div class="image">
                            {#<a href="{{ environment.generateUrl('galleries', 'view', { 'gallery_id': gallery.id }) }}">#}
                            {% set cover = get_attachment(gallery.photos[0].attachment.id, '450', '220', 'true') %}

                            {% if cover|length < 1 %}
                                {% if gallery.settings.posts.postCover|length > 1 %}
                                    {% set cover = gallery.settings.posts.postCover %}
                                {% else %}
                                    {% set cover = 'http://placehold.it/450x220&text=' ~ gallery.title %}
                                {% endif %}
                            {% endif %}
                            <img src="{{ cover }}" alt="{{ gallery.title }}"/>
                            {#</a>#}
                            {#<a class="delete-gallery" title="Delete this gallery"
                               href="{{ environment.generateUrl('galleries', 'delete', { 'gallery_id': gallery.id }) }}">
                                <i class="fa fa-trash-o fa-5x"></i>
                            </a>#}
                    </div>
                        <div class="controls-wrap" style="display: inline-block">
                            <!-- Control buttons -->
                            <ul class="gg-control-btn">
                                <li>
                                    <a href="{{ environment.generateUrl('galleries', 'settings', { 'gallery_id': gallery.id }) }}"
                                       class="button background">
                                        <i class="fa fa-gear"></i>
                                        {{ environment.translate('Settings') }}
                                    </a>
                                </li>
                                <li>
                                    <a href="{{ environment.generateUrl('galleries', 'view', { 'gallery_id': gallery.id }) }}"
                                       class="button background">
                                        <i class="fa fa-bars"></i>
                                        {{ environment.translate('Images List') }}
                                    </a>
                                </li>
                                <li>
                                    <a href="{{ environment.generateUrl('galleries', 'preview', { 'gallery_id': gallery.id }) }}"
                                       class="button background">
                                        <i class="fa fa-eye"></i>
                                        {{ environment.translate('Preview') }}
                                    </a>
                                </li>
                            </ul>
                            <ul class="gg-control-btn">
                                <li title="{{ environment.translate('Upload new images') }}">
                                    <button class="button button-primary gallery" id="gg-btn-upload" data-folder-id="0"
                                            data-gallery-id="{{ gallery.id }}" data-upload>
                                        <i class="fa fa-fw fa-camera"></i>
                                        {{ environment.translate('Add Images') }}
                                    </button>
                                </li>
                                <li>
                                    <a id="delete-gallery" class="button button-primary" title="Delete this gallery"
                                       href="{{ environment.generateUrl('galleries', 'delete', { 'gallery_id': gallery.id }) }}">
                                        <i class="fa fa-trash-o"></i>
                                        {{ environment.translate('Delete gallery') }}
                                    </a>
                                </li>
                            </ul>
                        </div>
                        <h4 style="display: inline-block; margin:8px 20px; height: 20px; float: left;">
                            {{ environment.translate('Shortcode: ') }}
                            <span title="{{ environment.translate('Select shortcode for the gallery ') ~ gallery.title }}"
                                  id="shortcode-{{ gallery.id }}}"
                                  class="gallery-shortcode">[supsystic-gallery id="{{ gallery.id }}" position="center"]
                            </span>
                        </h4>
                        <h4 style="display: inline-block; margin:6px 20px; float: left;">
                            <i class="fa fa-picture-o"></i>
                            {{ environment.translate('Total Images: ') }}
                            <div class="gg-counter"
                                 style="display: inline-block; font-weight: 200;"
                                 title="{{ environment.translate('There are %s photos in the gallery %s')|format(gallery.photos|length, gallery.title) }}">
                                {{ gallery.photos|length + gallery.settings.posts.length }}
                            </div>
                        </h4>
                    </div>
                {% else %}
                    <h3>{{ environment.translate('You have not any galleries') }}</h3>
                    <p>
                        {{ environment.translate('You don\'t have any galleries yet.') }}
                        <a href="{{ environment.config.get('ajax_url') }}"
                           id="gg-create-gallery-link">{{ environment.translate('Want to create one right now?') }}</a>
                    </p>

                    <h3>{{ environment.translate('What is a gallery') }}</h3>
                    <p>
                        {{ environment.translate('<strong>Gallery</strong> &mdash; the highest type of entity in the Gallery by Supsystic.')|raw }}
                        <br/>
                        {{ environment.translate('You can have an unlimited number of galleries, to which you can attach the preloaded pictures and folders.') }}
                        {{ environment.translate('Each gallery has a number of display settings and behaviors that you can save to presets and apply to other galleries.') }}
                    </p>

                    <h3>{{ environment.translate('Wanna know more?') }}</h3>
                    {% set help = '<a href="#">' ~ environment.translate('Help') ~ '</a>' %}
                    <p>{{ environment.translate('Visit %s section to read more information about the galleries.')|format(help)|raw }}</p>
                {% endfor %}
            </div>
        {% endif %}
    </section>

    {% macro putPreset(data) %}
        <div class="preset {% if environment.isPro() == false and data.pro %}disabled{% endif %}"
             data-preset="{{ data.value }}">
            <p>{{ data.title|title }}</p>
            <img src="{{ environment.getModule('galleries').getLocationUrl() }}/assets/img/{{ data.image }}" alt=""/>
            {% if data.pro and environment.isPro() == false %}
                <a class="button button-primary inPro"
                    {% if data.title == 'Categories' %}
                        href="http://dev.supsystic.com/plugins/gallery" target="_blank">
                    {% endif %}
                    {% if data.title == 'Icons' %}
                        href="http://dev.supsystic.com/plugins/gallery" target="_blank">
                    {% endif %}
                    {% if data.title == 'Pagination' %}
                        href="http://dev.supsystic.com/plugins/gallery" target="_blank">
                    {% endif %}
                    Available in PRO
                </a>
            {% endif %}
        </div>
    {% endmacro %}

    <!-- Create dialog -->
    {#<div id="gg-create-gallery-dialog" title="{{ environment.translate('Create new gallery') }}">
        <div id="newGalleryAlert" style="color:red;display:none">
            {{ environment.translate('Gallery title can\'t be empty!') }}
        </div>
        <div id="gg-create-gallery-text">
            <label style="float: left; margin: 4px 5px 0 0;">{{ environment.translate('Gallery title:') }}</label>
            <input name="title" type="text" style="float: left; width: 60%;"/>
            <button id="gallery-create" class="button button-primary" type="button">
                {{ environment.translate('Save') }}
            </button>
            <button id="gallery-cancel" class="button button-primary" type="button">
                {{ environment.translate('Cancel') }}
            </button>

            <div class="clear"></div>
            <input id="presetValue" name="preset" type="hidden" value="1"/>

            <div class="presetSelect">
                {% import _self as preset %}

                {% set presets = [
                {'title':'Default', 'image':'1-photo-gallery-default-settings.jpg', 'pro': false, 'value': 1},
                {'title':'Fluid, Border, Caption', 'image':'2-photo-gallery-borders.jpg', 'pro': false, 'value': 2},
                {'title':'Fluid, Shadow, Rounded', 'image':'3-round-cornerns.jpg', 'pro': false, 'value': 3},
                {'title':'Categories', 'image':'4-categories.jpg', 'pro': true, 'value': 4},
                {'title':'Icons', 'image':'5-icons.jpg', 'pro': true, 'value': 5},
                {'title':'Pagination', 'image':'6-pagination_circle-gallery.jpg', 'pro': true, 'value': 6}
                ] %}

                {% for data in presets %}
                    {{ preset.putPreset(data) }}
                {% endfor %}
            </div>
        </div>
        <div id="gg-create-gallery-loader" style="display: none;">
            <p class="gg-centered">

            <div class="gg-inline-loader gg-centered"></div>
            </p>
        </div>
    </div>#}

{% endblock %}